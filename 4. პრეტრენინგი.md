# XTTS-v2 ქართული ენის პრეტრეინინგი

ეს პროექტი ემსახურება XTTS-v2 მოდელის ქართული ენისთვის ადაპტაციას და პრეტრეინინგს. აქ მოცემულია ყველა საჭირო სკრიპტი მოდელის სხვადასხვა ეტაპის განსახორციელებლად, მათ შორის ემბედინგების დამუშავება, ფონემების მოდელირება და XTTS-v2 მოდელის ინიციალიზაცია.

## პროექტის სტრუქტურა

პროექტი შედგება შემდეგი სკრიპტებისა და დირექტორიებისგან:

### ძირითადი სკრიპტები

- **run_pretrain.py** - მთავარი გამშვები სკრიპტი, რომელიც ყველა ეტაპს ასრულებს და checkpoint სისტემის მეშვეობით აგრძელებს პროცესს გაწყვეტის შემთხვევაში.
- **pretrain_xtts_model.py** - ძირითადი სკრიპტი, რომელიც ახორციელებს მოდელის პრეტრეინინგს, შეიცავს ენის მოდელის, ფონემების მოდელის და XTTS-v2 მოდელის ინიციალიზაციის ლოგიკას.
- **run_xtts_pretrain.py** - უშუალოდ XTTS მოდელის პრეტრეინინგის გამშვები სკრიპტი, რომელიც იღებს `--step` პარამეტრს სხვადასხვა ეტაპების გასაშვებად.
- **embedding_adapter.py** - ადაპტერი, რომელიც ამზადებს წინა ეტაპზე შექმნილ ემბედინგებს XTTS-v2 მოდელისთვის.
- **phoneme_processor.py** - ქართული ენის ფონემების მოდელის და გრაფემა-ფონემა გარდამქმნელის იმპლემენტაცია.
- **data_loader.py** - მონაცემების ჩამტვირთავი, რომელიც ამზადებს ვოკალურ და ტექსტურ მონაცემებს მოდელის ტრენინგისთვის.
- **checkpoint_monitor.py** - Checkpoint-ების მონიტორინგის სკრიპტი, რომელიც საშუალებას იძლევა დავაკვირდეთ ტრენინგის პროცესს.
- **create_metadata_files.py** - დამხმარე სკრიპტი, რომელიც ქმნის საჭირო მეტადატას ფაილებს ტრენინგისთვის.
- **xtts_pretrain_config.json** - კონფიგურაციის ფაილი, რომელიც შეიცავს პრეტრეინინგის პარამეტრებს.

### დირექტორიები

- **data/** - მონაცემების დირექტორია
  - **split/** - დაყოფილი მონაცემთა ნაკრებები (ტრენინგი/ვალიდაცია/ტესტი)
  - **embeddings/embeddings/** - ვოკალური ემბედინგები

- **models/** - მოდელების დირექტორია
  - **base_xtts_v2/** - საბაზისო XTTS-v2 მოდელი
  - **xtts_v2_ka/** - ქართული XTTS-v2 მოდელის შედეგები

- **checkpoints/** - ტრენინგის პროცესში შექმნილი Checkpoint-ები

- **logs/** - ლოგების დირექტორია

## შექმნილი მოდელის ფაილები

პრეტრეინინგის პროცესის შედეგად შეიქმნა შემდეგი ფაილები `models/xtts_v2_ka/` დირექტორიაში:

- **g2p_model.pt** - გრაფემა-ფონემა გარდამქმნელი მოდელი, რომელიც ქართულ ტექსტს გადაიყვანს ფონემებში.
- **g2p_config.json** - გრაფემა-ფონემა მოდელის კონფიგურაცია.
- **phoneme_dict_ka.json** - ქართული ენის ფონემების ლექსიკონი, რომელიც შეიცავს ქართული ასოების შესაბამის ფონემებს.
- **phoneme_vocab.pkl** - ფონემების ვოკაბულარი, რომელიც გამოიყენება მოდელის მიერ.
- **language_model_results.pkl** - ენის მოდელის შედეგები, რომელიც გამოიყენება ტექსტის დასამუშავებლად.
- **phoneme_model_results.pkl** - ფონემების მოდელის შედეგები.
- **xtts_init_results.pkl** - XTTS მოდელის ინიციალიზაციის შედეგები.
- **xtts_v2_ka_combined.pkl** - საბოლოო კომბინირებული მოდელი, რომელიც აერთიანებს ყველა კომპონენტს.
- **xtts_v2_ka_config.json** - საბოლოო მოდელის კონფიგურაცია.
- **pretrain_progress.json** - პრეტრეინინგის პროგრესი და სტატუსი.

## სკრიპტების დეტალური აღწერა

### run_pretrain.py

მთავარი გამშვები სკრიპტი, რომელიც კოორდინირებას უწევს მთლიან პრეტრეინინგის პროცესს. ის იყენებს Checkpoint სისტემას, რაც საშუალებას იძლევა პროცესის გაწყვეტის შემთხვევაში გაგრძელდეს იქიდან, სადაც გაჩერდა.

**პარამეტრები:**
- `--config`: კონფიგურაციის ფაილის გზა
- `--force`: ყველა ეტაპის ხელახლა გაშვება
- `--only`: მხოლოდ კონკრეტული ეტაპის გაშვება (embeddings, phonemes, language, xtts_init, full_pretrain)

**გამოყენება:**
```bash
python run_pretrain.py --config xtts_pretrain_config.json
```

### pretrain_xtts_model.py

ძირითადი სკრიპტი, რომელიც ახორციელებს მოდელის პრეტრეინინგს. ის შეიცავს ენის მოდელის, ფონემების მოდელის და XTTS-v2 მოდელის ინიციალიზაციის ლოგიკას.

**კლასები:**
- `PretrainPipeline`: მთავარი კლასი, რომელიც მართავს პრეტრეინინგის პროცესს
- `LanguageModelProcessor`: ენის მოდელის დამუშავება
- `PhonemeModelProcessor`: ფონემების მოდელის დამუშავება
- `XTTSModelInitializer`: XTTS-v2 მოდელის ინიციალიზაცია
- `CheckpointManager`: Checkpoint-ების მართვა

### embedding_adapter.py

ადაპტერი, რომელიც ამზადებს წინა ეტაპზე შექმნილ ემბედინგებს XTTS-v2 მოდელისთვის. ის მოიძიებს არსებულ ემბედინგებს და კონვერტაციას გაუკეთებს XTTS-v2 ფორმატში.

**პარამეტრები:**
- `--config`: კონფიგურაციის ფაილის გზა
- `--force`: არსებული ფაილების გადაწერა

**გამოყენება:**
```bash
python embedding_adapter.py --config xtts_pretrain_config.json
```

### phoneme_processor.py

ქართული ენის ფონემების მოდელის და გრაფემა-ფონემა გარდამქმნელის იმპლემენტაცია. ეს სკრიპტი ქმნის მოდელს, რომელიც ქართულ ტექსტს გადაიყვანს ფონემებში.

**კლასები:**
- `PhonemeProcessor`: მთავარი კლასი, რომელიც მართავს ფონემების დამუშავებას
- `PhonemeVocab`: ფონემების ლექსიკონი
- `GraphemeToPhoneme`: გრაფემა-ფონემა გარდამქმნელი მოდელი
- `PhonemeEncoder`: ფონემების ენკოდერი

**გამოყენება:**
```bash
python phoneme_processor.py --config xtts_pretrain_config.json
```

### data_loader.py

მონაცემების ჩამტვირთავი, რომელიც ამზადებს ვოკალურ და ტექსტურ მონაცემებს მოდელის ტრენინგისთვის.

**კლასები:**
- `XTTSDataset`: XTTS-v2 მოდელის მონაცემთა ნაკრები
- `DataManager`: მონაცემების მართვის კლასი
- `CollateFunction`: მონაცემების დაჯგუფება ბეტჩებად

### checkpoint_monitor.py

Checkpoint-ების მონიტორინგის სკრიპტი, რომელიც საშუალებას იძლევა დავაკვირდეთ ტრენინგის პროცესს, ვნახოთ პროგრესი და დავადგინოთ დასრულების სავარაუდო დრო.

**პარამეტრები:**
- `--config`: კონფიგურაციის ფაილის გზა
- `--plot`: პროგრესის გრაფიკის გენერაცია
- `--watch`: განახლებების მუდმივი მონიტორინგი
- `--interval`: მონიტორინგის ინტერვალი წამებში
- `--cleanup`: ძველი Checkpoint-ების გასუფთავება
- `--analyze`: Loss-ის ტრენდების ანალიზი
- `--export`: სტატისტიკის ექსპორტი CSV ფაილში

**გამოყენება:**
```bash
python checkpoint_monitor1.py --config xtts_pretrain_config.json --watch --plot --interval 300
```

### create_metadata_files.py

დამხმარე სკრიპტი, რომელიც ქმნის საჭირო მეტადატას ფაილებს ტრენინგისთვის.

**პარამეტრები:**
- `--embeddings_dir`: ემბედინგების დირექტორიის გზა
- `--output_dir`: შედეგების დირექტორიის გზა

**გამოყენება:**
```bash
python create_metadata_files.py
```

## გამოყენების ინსტრუქცია

1. **კონფიგურაციის მომზადება**:
   კონფიგურაციის ფაილის (`xtts_pretrain_config.json`) შექმნა ან მორგება თქვენი საჭიროებების მიხედვით.

2. **მეტადატას ფაილების შექმნა**:
   ```bash
   python create_metadata_files.py
   ```

3. **პრეტრეინინგის გაშვება**:
   ```bash
   python run_pretrain.py --config xtts_pretrain_config.json
   ```

4. **ტრენინგის მონიტორინგი**:
   ```bash
   python checkpoint_monitor1.py --config xtts_pretrain_config.json --watch --plot
   ```

5. **შედეგების შეფასება**:
   ```bash
   python checkpoint_monitor1.py --config xtts_pretrain_config.json --analyze
   ```

## შემდეგი ნაბიჯები

პრეტრეინინგის დასრულების შემდეგ, შემდეგი ნაბიჯები შეიძლება იყოს:

1. **რეალური აუდიო მონაცემების მომზადება** - შეგროვება, სეგმენტაცია და წინასწარი დამუშავება.
2. **მეტადატას ფაილების შექმნა** - დირექტორიებში data/split/train, data/split/val და data/split/test შესაბამისი CSV ფაილების განთავსება.
3. **ფაინთიუნინგი** - ამ პრეტრენირებული მოდელის გაწვრთნა რეალურ ქართულ ხმოვან მონაცემებზე.
4. **ტესტირება** - მოდელის შეფასება და გამოყენება ქართული ტექსტის გახმოვანებისთვის.

## მოთხოვნები

- Python 3.9+
- PyTorch
- torchaudio
- numpy
- pandas
- matplotlib
- tqdm

## ლიცენზია

[მიუთითეთ ლიცენზიის ტიპი]

## ავტორები

[მიუთითეთ ავტორები]